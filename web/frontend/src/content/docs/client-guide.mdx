---
title: Client Integration Guide
description: Integrate x402x payments into your browser or client application.
navGroup: Facilitator
navOrder: 4
status: beta
---

This guide covers both integration modes from the client perspective.

import { CodeTabs } from "@/components/ui/shadcn-io/code-tabs";

## Install

<CodeTabs
  codes={{
    npm: "npm install @x402x/client @x402x/extensions @x402/fetch @x402/core viem",
    pnpm: "pnpm add @x402x/client @x402x/extensions @x402/fetch @x402/core viem",
    yarn: "yarn add @x402x/client @x402x/extensions @x402/fetch @x402/core viem",
    bun: "bun add @x402x/client @x402x/extensions @x402/fetch @x402/core viem",
  }}
  lang="bash"
/>

---

## Mode A: Server-Validated

Use this when your backend returns 402 responses. The SDK handles negotiation, signing, and retry automatically.

```typescript
import { wrapFetchWithPayment } from "@x402/fetch";
import { x402Client } from "@x402/core/client";
import { registerX402xScheme } from "@x402x/extensions";

// 1. Create a signer from your wallet (e.g., wagmi walletClient)
const signer = {
  address: walletClient.account.address,
  signTypedData: (params) => walletClient.signTypedData(params),
};

// 2. Create client and register x402x scheme
const client = new x402Client();
registerX402xScheme(client, "eip155:84532", signer); // Base Sepolia

// 3. Wrap fetch - it handles 402 automatically!
const fetchWithPayment = wrapFetchWithPayment(fetch, client);

// 4. Use like normal fetch - payment happens transparently
const response = await fetchWithPayment("/api/premium-content", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ /* your data */ }),
});

const result = await response.json();
```

**How it works:**
1. Your request hits a 402 Protected endpoint
2. SDK parses payment requirements from response headers
3. Signs EIP-3009 authorization
4. Retries request with payment header
5. Server verifies via Facilitator and returns content

---

## Mode B: Serverless

Use this to call the Facilitator directly from browser, no backend needed.

### High-Level API (Recommended)

```typescript
import { x402xClient } from "@x402x/client";
import { TransferHook } from "@x402x/extensions";

const client = new x402xClient({
  wallet,                // viem wallet client (e.g. from wagmi)
  network: "eip155:84532",
  facilitatorUrl: "https://facilitator.x402x.dev",
});

// Example 1: Simple transfer (hook defaults to TransferHook, no splits)
const res1 = await client.execute({
  amount: "1000000",     // 1.00 USDC (atomic units)
  payTo: "0xMerchant...",
});
console.log("Simple transfer:", res1.txHash);

// Example 2: Revenue split (70% to merchant, 30% to platform)
const res2 = await client.execute({
  hook: TransferHook.getAddress("base-sepolia"),
  hookData: TransferHook.encode([
    { recipient: "0xPlatform...", bips: 3000 }, // 30% to platform
  ]),
  amount: "1000000",     // 1.00 USDC (merchant gets remaining 70%)
  payTo: "0xMerchant...", // Primary recipient gets remaining amount
});
console.log("Revenue split:", res2.txHash);
```

### React Hook

```tsx
import { useX402xClient } from "@x402x/client";

function PayButton() {
  const client = useX402xClient({ 
    facilitatorUrl: "https://facilitator.x402x.dev" 
  });

  const handlePay = async () => {
    if (!client) return;
    const result = await client.execute({ 
      amount: "1000000", 
      payTo: "0xMerchant..." 
    });
    console.log("Paid:", result.txHash);
  };

  if (!client) return <div>Connect wallet first</div>;
  return <button onClick={handlePay}>Pay $1</button>;
}
```

Under the hood the client:
- Queries min facilitator fee (or uses your provided fee)
- Prepares the settlement and computes the commitment (nonce)
- Signs EIP-3009 with EIP-712
- Submits to the facilitator and waits for confirmation (optional)

---

## Low-Level Primitives

For full control over the settlement flow:

```typescript
import { prepareSettlement, signAuthorization, settle } from "@x402x/client";
import { TransferHook } from "@x402x/extensions";

const settlement = await prepareSettlement({
  wallet,
  network: "base-sepolia",
  hook: TransferHook.getAddress("base-sepolia"),
  hookData: TransferHook.encode(),
  amount: "1000000",
  payTo: "0xMerchant...",
  // facilitatorFee?: string  // optional; will be queried if omitted
});

const signed = await signAuthorization(wallet, settlement);
const result = await settle("https://facilitator.x402x.dev", signed);

console.log('Settlement result:', {
  success: result.success,
  transaction: result.transaction,
  network: result.network,
  payer: result.payer
});
```

---

## CORS Notes

If calling a hosted facilitator from the browser, configure CORS on the facilitator
(`CORS_ORIGIN=https://yourapp.com` or a list of origins). See facilitator README for details.

---

import { RelatedLinks } from "@/components/docs/related-links";

## Related Docs

<RelatedLinks
  items={[
    {
      title: "Server-Side Guide",
      href: "./server-guide",
      description: "Protect your API routes with payment middleware.",
    },
    {
      title: "Facilitator Fee",
      href: "./facilitator-fee",
      description: "How fees work and how to manage them.",
    },
    {
      title: "Facilitator README",
      href: "https://github.com/nuwa-protocol/x402-exec/blob/main/facilitator/README.md",
      description: "CORS, security knobs, and production deployment.",
    },
  ]}
/>
