---
title: Server Integration Guide
description: Protect routes with x402 and settle via facilitator.
navGroup: Facilitator
navOrder: 5
status: beta
---

Use official x402 middlewares with the x402x extension to automatically handle payment verification and settlement.

import { CodeTabs } from "@/components/ui/shadcn-io/code-tabs";

## Install

<CodeTabs
  codes={{
    npm: "npm install @x402/hono @x402/evm @x402x/extensions",
    pnpm: "pnpm add @x402/hono @x402/evm @x402x/extensions",
    yarn: "yarn add @x402/hono @x402/evm @x402x/extensions",
    bun: "bun add @x402/hono @x402/evm @x402x/extensions",
  }}
  lang="bash"
/>

---

## Hono

```typescript
import { Hono } from "hono";
import { paymentMiddleware, x402ResourceServer } from "@x402/hono";
import { registerExactEvmScheme } from "@x402/evm";
import { registerRouterSettlement, createSettlementRouteConfig, TransferHook } from "@x402x/extensions";
import { HTTPFacilitatorClient } from "@x402/core/http";

const app = new Hono();

// 1. Setup Resource Server
const facilitatorClient = new HTTPFacilitatorClient({ url: process.env.FACILITATOR_URL! });
const server = new x402ResourceServer(facilitatorClient);

registerExactEvmScheme(server, {});
registerRouterSettlement(server); // <--- Key: Enable settlement extension

// 2. Initialize
await server.initialize();

// 3. Define Routes with Settlement Config
const routes = {
  "/api/premium": createSettlementRouteConfig({
    accepts: {
      scheme: "exact",
      network: "base-sepolia",
      payTo: "0xMerchant...",
      price: "$0.10",
    }},
    {
      hook: TransferHook.getAddress("base-sepolia"),
      hookData: TransferHook.encode(),
      facilitatorFee: "10000"
    }
  )
};

// 4. Use Middleware
app.use("/api/*", paymentMiddleware(routes, server));

app.get("/api/premium", (c) => {
  // Payment confirmed/settled by middleware
  return c.json({ ok: true, message: "Premium content" });
});
```

---

## Express

*Coming soon: Use `@x402/express` with similar `x402ResourceServer` configuration.*

---

## Notes

- `createSettlementRouteConfig` helper simplifies creating valid v2 payment requirements with extension fields.
- The `x402ResourceServer` handles communication with the Facilitator to settle payments before passing control to your handler.

See the [Facilitator Fee documentation](./facilitator-fee) for information about fee management.

---

import { RelatedLinks } from "@/components/docs/related-links";

## Related Docs

<RelatedLinks
  items={[
    {
      title: "Client Integration Guide",
      href: "./client-guide",
      description: "Browser/app integration for paying clients.",
    },
    {
      title: "Facilitator README",
      href: "https://github.com/nuwa-protocol/x402-exec/blob/main/facilitator/README.md",
      description: "End-to-end setup and ops guidance.",
    },
    {
      title: "Facilitator Developer Guide",
      href: "https://github.com/nuwa-protocol/x402-exec/blob/main/contracts/docs/facilitator_guide.md",
      description: "Language-agnostic integration if you run your own.",
    },
  ]}
/>
